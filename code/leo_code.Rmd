---
title: "fish-in-space"
author: "Leonardo Feitosa"
date: "04/04/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rnaturalearth)
library(sf)
library(here)
library(tmap)
library(janitor)
library(tmaptools)
```

```{r}
# Set directories
basedir <- "G:/Meu Drive/fish_mgmt_areas/data"
indir <- file.path(basedir, "gulf_of_mexico", "raw")
outdir <- file.path(basedir, "us_east_coast", "processed")
plotdir <- "figures"
```


```{r}
# read in the data
df_orig_raw <- st_read(file.path(indir, "lobster_trap_gear_po.shp")) %>% 
  clean_names()

# rnaturalearth data
world <- ne_countries(scale = "medium", returnclass = "sf")
```

```{r}
# Set coordinate system
wgs84 <- st_crs("+proj=longlat +datum=WGS84")
```

```{r}
# Inspect attribute table
df <- df_orig_raw %>% 
  st_drop_geometry() 
```

```{r}
df_final <- df_orig_raw %>%  
  mutate(dataset = "Spiny Lobster Trap Gear Fishery Management Areas",
        country = "USA",
        ocean = "Atlantic",
        region = "Florida Keys",
        agency = "NOAA",
        zone_id = as.character(lobster_id),
        zone_name = lobster_id,
        type = "management",
        species = "spiny lobster",
        species_list = NA,
        source = "https://www.fisheries.noaa.gov/resource/map/spiny-lobster-trap-gear-fishery-management-areas-map-gis-data",
        citation = "NOAA Fisheries. (18 October 2019). Spiny Lobster Trap Gear Fishery Management Areas. https://www.fisheries.noaa.gov/. Retrieved 28 July 2022: https://www.fisheries.noaa.gov/resource/map/spiny-lobster-trap-gear-fishery-management-areas-map-gis-data") %>% 
  select(dataset, country, ocean, region, agency, zone_id, zone_name, type, species, species_list, source, citation) %>% 
 st_transform(wgs84)
```

```{r}
# Create output RDS file
saveRDS(df_final, file = file.path(outdir, "USA_spiny_lobster_mgmt_areas.Rds"))
```

```{r}
ggplot() +
#  geom_sf(data = world) +
  geom_sf(data = df_orig_raw, aes(fill = lobster_id),
          alpha = 0.5) 
  coord_sf(xlim = c(-86, -66),
           ylim = c(30, 46)) 
```

```{r}
stur_1 <- st_read(file.path(indir, "SturgeonAtlantic_AtlanticSubspecies_SouthAtlanticDPS_20170817.shp")) %>% 
  clean_names()   

stur_2 <- st_read(file.path(indir, "SturgeonAtlantic_AtlanticSubspecies_NewYorkBightDPS_20170817.shp")) %>% 
  clean_names()  

stur_3 <- st_read(file.path(indir, "SturgeonAtlantic_AtlanticSubspecies_GulfofMaineDPS_20170817.shp")) %>% 
  clean_names()  

stur_4 <- st_read(file.path(indir, "SturgeonAtlantic_AtlanticSubspecies_CarolinaDPS_20170817.shp")) %>% 
  clean_names()  

wash_10 <- st_read(file.path(indir, "washington_state_fish_mgmt_areas10.shp")) %>% 
  clean_names()  

wash_12 <- st_read(file.path(indir, "washington_state_fish_mgmt_areas12.shp")) %>% 
  clean_names() 

wash_14 <- st_read(file.path(indir, "washington_state_fish_mgmt_areas14.shp")) %>% 
  clean_names()  

stur_all <- bind_rows(stur_1, stur_2, stur_3, stur_4) %>% 
   st_transform(wgs84)

stur_all_drop <- stur_all %>% 
  st_drop_geometry()
```


```{r}
costa_rica_atl <- readRDS(file.path(outdir, "Costa_Rica_Marine_Areas_of_Responsible_Fishing_Pacific.Rds"))

argentina <- st_zm(argentina, drop = TRUE, what = "ZM")

st_write(argentina, file.path(outdir, "Argentina_fisheries_management_areas.shp"))
```

