---
title: "fish-in-space"
author: "Leonardo Feitosa"
date: "04/04/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rnaturalearth)
library(sf)
library(here)
library(tmap)
library(janitor)
library(tmaptools)
```

```{r}
# Set directories
basedir <- "G:/Meu Drive/fish_mgmt_areas/data"
indir <- file.path(basedir, "us_east_coast", "raw")
outdir <- file.path(basedir, "us_east_coast", "processed")
plotdir <- "figures"
```


```{r}
# read in the data
df_orig <- readRDS(file.path(outdir, "SturgeonAtlantic_AtlanticSubspecies.rds")) 

# rnaturalearth data
world <- ne_countries(scale = "medium", returnclass = "sf")
```

```{r}
# Set coordinate system
wgs84 <- st_crs("+proj=longlat +datum=WGS84")
```

```{r}
# Inspect attribute table
df <- df_orig %>% 
  st_drop_geometry() 
```


```{r}
# Wrangle the data into a df and export it
df_final <- df_orig %>%  
  mutate(dataset = dataset,
        country = country,
        ocean = ocean,
        region = region,
        agency = agency,
        zone_id = as.character(zone_id),
        zone_name = zone_name,
        species = species,
        source = source) 
```

```{r}
# Create output RDS file
saveRDS(df_final, file = file.path(outdir, "SturgeonAtlantic_AtlanticSubspecies.Rds"))
```

```{r}
ggplot() +
#  geom_sf(data = world) +
  geom_sf(data = df_orig, fill = NA) 
  geom_sf(data = df_orig_2, aes(fill = name)) +
  coord_sf(xlim = c(-80, -50),
           ylim = c(-30, -60)) 
```

```{r}
wash_2 <- st_read(file.path(indir, "washington_state_fish_mgmt_areas2.shp")) %>% 
  clean_names()   
  select(objectid, shape_leng) #multipolygon - commercial salmon closures df

wash_4 <- st_read(file.path(indir, "washington_state_fish_mgmt_areas4.shp")) %>% 
  clean_names()  
    select(objectid, shape_leng) #polygon

wash_6 <- st_read(file.path(indir, "washington_state_fish_mgmt_areas6.shp")) %>% 
  clean_names()  
    select(objectid, shape_leng) #multipolygon - do not use

wash_8 <- st_read(file.path(indir, "washington_state_fish_mgmt_areas8.shp")) %>% 
  clean_names()  
    select(objectid, shape_leng) #polygon - Commercial marine fish and shellfish areas for the Salish Sea

wash_10 <- st_read(file.path(indir, "washington_state_fish_mgmt_areas10.shp")) %>% 
  clean_names()  
    select(objectid, shape_leng) #multipolygon

wash_12 <- st_read(file.path(indir, "washington_state_fish_mgmt_areas12.shp")) %>% 
  clean_names() 

wash_14 <- st_read(file.path(indir, "washington_state_fish_mgmt_areas14.shp")) %>% 
  clean_names()  
    select(objectid, shape_leng) #multipolygon

wash_all <- bind_rows(wash_2, wash_4,
                      wash_6,wash_8,
                      wash_10, wash_12,
                      wash_14) %>% 
   st_transform(wgs84)

wash_all_drop <- wash_all %>% 
  st_drop_geometry()
```


```{r}
costa_rica_atl <- readRDS(file.path(outdir, "Costa_Rica_Marine_Areas_of_Responsible_Fishing_Pacific.Rds"))

argentina <- st_zm(argentina, drop = TRUE, what = "ZM")

st_write(argentina, file.path(outdir, "Argentina_fisheries_management_areas.shp"))
```

