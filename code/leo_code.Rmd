---
title: "fish-in-space"
author: "Leonardo Feitosa"
date: "04/04/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rnaturalearth)
library(sf)
library(here)
library(janitor)
```

```{r}
# Set directories
basedir <- "G:/Meu Drive/fish_mgmt_areas/data"
indir <- file.path(basedir, "canada", "raw")
outdir <- file.path(basedir, "canada", "processed")
plotdir <- "figures"
```


```{r}
# read in the data
df_orig <- st_read(file.path(indir, "pfma_areas_inside_outside.shp")) %>% 
  clean_names()

# rnaturalearth data
world <- ne_countries(scale = "medium", returnclass = "sf")
```

```{r}
# Set coordinate system
wgs84 <- st_crs("+proj=longlat +datum=WGS84")
```

```{r}
# Inspect attribute table
df <- df_orig %>% 
  st_drop_geometry()
```


```{r}
# Wrangle the data into a df and export it
df_final <- df_orig %>% 
  mutate(dataset = "Pacific Fishery Management Areas Inside Outside",
         country = "Canada",
         ocean = "Pacific",
         region = "NW Pacific",
         agency = "Fisheries and Oceans Canada",
         zone_name = NA,
         species = "multi-species",
         source = "https://marine.rutgers.edu/~cfree/files/dfo_shapefiles/dfo_west_pfma_areas.zip") %>% 
  rename(zone_id = unit) %>% 
  select(dataset, country, ocean, region, agency, zone_id, zone_name, species, source) %>% 
  st_transform(wgs84)
```

```{r}
# Create output RDS file
saveRDS(df_final, file = file.path(outdir, "pfma_areas_inside_outside.Rds"))
```

```{r}
  #    +     geom_sf(data = world),
          #aes(color = name)) +
# Create plot
ggplot() +
#  geom_sf(data = world) +
  geom_sf(data = df_orig,
          aes(fill = unit)) 
  coord_sf(xlim = c(10, -160),
           ylim = c(40, 57))
```

